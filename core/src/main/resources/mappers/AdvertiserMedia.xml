<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.madhouse.platform.premiummad.dao.AdvertiserMediaMapper" >
  <resultMap id="UnionResultMap" type="com.madhouse.platform.premiummad.entity.AdvertiserMediaUnion" >
    <!-- 包含DSP定义的广告主ID集合 -->
    <id column="id" property="id" jdbcType="INTEGER" />
    <result column="advertiser_id" property="advertiserId" jdbcType="INTEGER" />
    <result column="advertiser_key" property="advertiserKey" jdbcType="VARCHAR" />
    <result column="media_id" property="mediaId" jdbcType="INTEGER" />
    <result column="auditee" property="auditee" jdbcType="BIT" />
    <result column="status" property="status" jdbcType="TINYINT" />
    <result column="reason" property="reason" jdbcType="VARCHAR" />
    <result column="audited_user" property="auditedUser" jdbcType="INTEGER" />
    <result column="created_time" property="createdTime" jdbcType="TIMESTAMP" />
    <result column="audited_time" property="auditedTime" jdbcType="TIMESTAMP" />
  </resultMap>
  <sql id="Union_Column_List" >
    <!-- 包含DSP定义的广告主ID集合 -->
    adm.id, adm.advertiser_id, adm.media_id, adm.auditee, adm.status, adm.reason, 
    adm.audited_user, adm.created_time, adm.audited_time, ad.advertiser_key
  </sql>
  <select id="selectAdvertiserMedias" resultMap="UnionResultMap">
    select 
    <include refid="Union_Column_List" />
    from mad_sys_advertiser_media adm
    left join mad_sys_advertiser ad on ad.id = adm.advertiser_id
	where ad.advertiser_key in
	   <foreach collection="advertiserKeys" item="advertiserKey" index="index"
           open="(" close=")" separator=",">
           #{advertiserKey,jdbcType=VARCHAR}}
        </foreach>
	)
  </select>
</mapper>